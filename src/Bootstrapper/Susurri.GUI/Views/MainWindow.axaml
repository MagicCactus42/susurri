<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Susurri.GUI.ViewModels"
        xmlns:views="using:Susurri.GUI.Views"
        x:Class="Susurri.GUI.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="Susurri"
        Width="900" Height="600"
        MinWidth="700" MinHeight="500"
        WindowStartupLocation="CenterScreen"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="PreferSystemChrome"
        Background="{StaticResource BackgroundPrimaryBrush}">

    <Grid ColumnDefinitions="220,*">
        <!-- Sidebar -->
        <Border Grid.Column="0"
                Background="{StaticResource BackgroundSecondaryBrush}"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="0,0,1,0">
            <Grid RowDefinitions="Auto,*,Auto">
                <!-- Logo/Brand -->
                <StackPanel Grid.Row="0" Margin="20,24,20,20">
                    <TextBlock Text="Susurri"
                               FontSize="22"
                               FontWeight="Bold"
                               Foreground="{StaticResource TextPrimaryBrush}" />
                    <TextBlock Text="Secure P2P Chat"
                               FontSize="12"
                               Foreground="{StaticResource TextMutedBrush}"
                               Margin="0,4,0,0" />
                </StackPanel>

                <!-- Navigation -->
                <StackPanel Grid.Row="1" Margin="12,0" Spacing="4">
                    <Button Classes="nav-item"
                            Command="{Binding NavigateCommand}"
                            CommandParameter="Dashboard"
                            IsVisible="{Binding AppState.IsLoggedIn}">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <TextBlock Text="◉" FontSize="14" />
                            <TextBlock Text="Dashboard" />
                        </StackPanel>
                    </Button>

                    <Button Classes="nav-item"
                            Command="{Binding NavigateCommand}"
                            CommandParameter="Generate">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <TextBlock Text="◈" FontSize="14" />
                            <TextBlock Text="Generate Key" />
                        </StackPanel>
                    </Button>

                    <Button Classes="nav-item"
                            Command="{Binding NavigateCommand}"
                            CommandParameter="Settings"
                            IsVisible="{Binding AppState.IsLoggedIn}">
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <TextBlock Text="◎" FontSize="14" />
                            <TextBlock Text="Settings" />
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Status Footer -->
                <Border Grid.Row="2"
                        Background="{StaticResource BackgroundTertiaryBrush}"
                        CornerRadius="8"
                        Margin="12,12"
                        Padding="12">
                    <StackPanel Spacing="8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <Ellipse Classes.status-online="{Binding AppState.IsLoggedIn}"
                                     Classes.status-offline="{Binding !AppState.IsLoggedIn}" />
                            <TextBlock Text="{Binding AppState.Username, FallbackValue='Not logged in'}"
                                       FontSize="13"
                                       Foreground="{StaticResource TextSecondaryBrush}" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="8"
                                    IsVisible="{Binding AppState.IsDhtRunning}">
                            <Ellipse Classes="status-online" />
                            <TextBlock Text="DHT Active"
                                       FontSize="12"
                                       Foreground="{StaticResource TextMutedBrush}" />
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Border Grid.Column="1" Padding="32">
            <ContentControl Content="{Binding CurrentView}">
                <ContentControl.DataTemplates>
                    <DataTemplate DataType="vm:LoginViewModel">
                        <views:LoginView />
                    </DataTemplate>
                    <DataTemplate DataType="vm:DashboardViewModel">
                        <views:DashboardView />
                    </DataTemplate>
                    <DataTemplate DataType="vm:GenerateViewModel">
                        <views:GenerateView />
                    </DataTemplate>
                    <DataTemplate DataType="vm:SettingsViewModel">
                        <views:SettingsView />
                    </DataTemplate>
                </ContentControl.DataTemplates>
            </ContentControl>
        </Border>
    </Grid>
</Window>
